import{e as f,v,x as w,y as i,bx as b,r as O,h as d,by as h}from"./index.8b05d2db.js";import{l as S}from"./index.80337ce4.js";import{b as z}from"./base.12718b58.js";import{L as _,m as M,s as g,c as y,a as P}from"./data.527e3bf3.js";import{N as B}from"./Icon.f91ce72e.js";const G={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},V=i("path",{d:"M80 212v236a16 16 0 0 0 16 16h96V328a24 24 0 0 1 24-24h80a24 24 0 0 1 24 24v136h96a16 16 0 0 0 16-16V212",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),L=i("path",{d:"M480 256L266.89 52c-5-5.28-16.69-5.34-21.78 0L32 256",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),E=i("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M400 179V64h-48v69"},null,-1),$=[V,L,E];var j=f({name:"HomeOutline",render:function(t,o){return v(),w("svg",G,$)}});const F=5e3;function r(e,t){t=Object.assign({method:"GET",headers:{"Content-type":"application/x-www-form-urlencoded"},credentials:"include",mode:"cors",cache:"no-cache"},t);const{method:u,handle:l,body:n}=t;if(u==="GET"&&n.constructor===Object){const a=[];Object.keys(n).forEach(s=>a.push(s+"="+encodeURIComponent(n[s]))),e.search(/\?/)===-1?e+="?"+a.join("&"):e+="&"+a.join("&"),delete t.body}else u==="POST"&&n.constructor===Object&&(t.body=S.stringify(n));return Promise.race([new Promise((a,s)=>{setTimeout(()=>{s(new Error("request timeout"))},F)}),new Promise((a,s)=>{fetch(z+e,t).then(async c=>{if(!/^(2|3)\d{2}$/.test(String(c.status))){switch(c.status){case 401:window.$notification.warning({duration:2e3,content:"\u8B66\u544A",meta:"\u672A\u767B\u5F55\uFF0C\u8BF7\u5148\u767B\u5F55\uFF01"}),b.push({name:"login"});break;case 403:console.log("\u767B\u5F55\u9519\u8BEF");break}return Promise.reject(c)}if(l){const A=c.json();a(A)}else a(c.text())}).catch(c=>{s(c)})})])}const N={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},R=i("g",{fill:"none"},[i("path",{d:"M2 3.5A1.5 1.5 0 0 1 3.5 2h1A1.5 1.5 0 0 1 6 3.5v1A1.5 1.5 0 0 1 4.5 6h-1A1.5 1.5 0 0 1 2 4.5v-1zM3.5 3a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1zM2 9.5A1.5 1.5 0 0 1 3.5 8h1A1.5 1.5 0 0 1 6 9.5v1A1.5 1.5 0 0 1 4.5 12h-1A1.5 1.5 0 0 1 2 10.5v-1zM3.5 9a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1zM2 15.5A1.5 1.5 0 0 1 3.5 14h1A1.5 1.5 0 0 1 6 15.5v1A1.5 1.5 0 0 1 4.5 18h-1A1.5 1.5 0 0 1 2 16.5v-1zm1.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1zM8 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5z",fill:"currentColor"})],-1),D=[R];var H=f({name:"AppsList20Regular",render:function(t,o){return v(),w("svg",N,D)}});const I={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},U=i("g",{fill:"none"},[i("path",{d:"M4 4a2 2 0 0 1 1-1.732V16a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1h-2V2h2a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4zm2-2v6.5a.5.5 0 0 0 .8.4l1.7-1.275L10.2 8.9a.5.5 0 0 0 .8-.4V2H6zm1 5.5V3h3v4.5l-1.2-.9a.5.5 0 0 0-.6 0L7 7.5z",fill:"currentColor"})],-1),K=[U];var q=f({name:"Class20Regular",render:function(t,o){return v(),w("svg",I,K)}});const J={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Q=i("g",{fill:"none"},[i("path",{d:"M2 3.498C2 2.67 2.671 2 3.5 2h1c.827 0 1.499.67 1.499 1.498V16.48c0 .827-.672 1.497-1.5 1.497h-1c-.828 0-1.499-.67-1.499-1.497V3.498zm1.5-.5a.5.5 0 0 0-.5.5V16.48a.5.5 0 0 0 .5.499h1a.5.5 0 0 0 .499-.5V3.499a.5.5 0 0 0-.5-.5h-1zm3.498.5C6.998 2.67 7.67 2 8.498 2h1c.828 0 1.499.67 1.499 1.498V16.48c0 .827-.671 1.497-1.5 1.497h-1c-.827 0-1.499-.67-1.499-1.497V3.498zm1.5-.5a.5.5 0 0 0-.5.5V16.48a.5.5 0 0 0 .5.499h1a.5.5 0 0 0 .5-.5V3.499a.5.5 0 0 0-.5-.5h-1zm7.22 3.159a1.5 1.5 0 0 0-1.87-1.106l-.745.21a1.498 1.498 0 0 0-1.06 1.741l2.003 9.8a1.5 1.5 0 0 0 1.839 1.151l.985-.25c.79-.2 1.274-.994 1.092-1.787l-2.244-9.76zm-1.598-.145a.5.5 0 0 1 .624.368l2.243 9.76a.5.5 0 0 1-.364.595l-.985.25a.5.5 0 0 1-.613-.383l-2.003-9.8a.5.5 0 0 1 .353-.58l.745-.21z",fill:"currentColor"})],-1),W=[Q];var X=f({name:"Library20Regular",render:function(t,o){return v(),w("svg",J,W)}});const Y={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Z=i("g",{fill:"none"},[i("path",{d:"M16.13 5.38L7.038 8h9.46a.5.5 0 0 1 .5.5v7a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 3 15.5V8.571l-.257-.893a2.5 2.5 0 0 1 1.71-3.095l8.647-2.493a2.5 2.5 0 0 1 3.095 1.71l.277.96a.5.5 0 0 1-.342.62zM3.84 7.88l.607-.175L5.889 5.21l-1.16.335A1.5 1.5 0 0 0 3.703 7.4l.138.48zm1.992-.574l2.12-.612l1.443-2.497l-2.125.613a.51.51 0 0 1-.021.042L5.833 7.307zm5.627-1.622l1.442-2.498l-2.126.613a.517.517 0 0 1-.026.053L9.34 6.296l2.12-.611zm2.684-2.652a.54.54 0 0 1-.02.036l-1.279 2.216l2.527-.728l-.139-.48a1.5 1.5 0 0 0-1.09-1.044zM4 9v6.5A1.5 1.5 0 0 0 5.5 17h9a1.5 1.5 0 0 0 1.5-1.5V9H4z",fill:"currentColor"})],-1),ee=[Z];var te=f({name:"MoviesAndTv20Regular",render:function(t,o){return v(),w("svg",Y,ee)}});function m(e){return()=>d(B,null,{default:()=>d(e)})}let ae=[{label:()=>d(h,{to:{name:"panel"}},{default:()=>"\u4EEA\u8868\u76D8"}),key:"instrument-panel",icon:m(j)},{label:()=>d(h,{to:{name:"source"}},{default:()=>"\u91C7\u96C6\u6E90"}),key:"source",icon:m(X)},{label:()=>d(h,{to:{name:"category"}},{default:()=>"\u5206\u7C7B\u7BA1\u7406"}),key:"category-management",icon:m(q)},{label:()=>d(h,{to:{name:"movies"}},{default:()=>"\u5F71\u7247\u7BA1\u7406"}),key:"movie-management",icon:m(te)}];const p=O([]);function oe(e,t){return{label:e,key:t,children:[{label:()=>d(h,{to:{name:"source-detail-class",params:{id:t}}},{default:()=>"\u91C7\u96C6\u7C7B"}),key:String(t)+"-caiji"},{label:()=>d(h,{to:{name:"source-detail-movie",params:{id:t}}},{default:()=>"\u5F71\u7247"}),key:String(t)+"-movie"}],icon:m(H)}}function ce(){_.value||k().then(()=>{C(),T(),x()})}function de(e,t){r("/user/login",{method:"POST",handle:!1,body:{account:e,password:t}}).then(async()=>{await k(),await C(),await T(),await x(),_.value=!0,b.push({name:"panel"})})}function he(){return r("/user/logout",{method:"GET",handle:!1,body:{}})}async function k(){const e=await r("/user/count",{method:"GET",handle:!1,body:{}});M.value=Number(e)}function x(){return ne(20,1,P)}async function ne(e,t,o,u){const l=await r("/user/list",{method:"POST",handle:!0,body:{num:e,pg:t}});o.value=[];for(const n of l.movies){let a={id:n.id,name:n.name,description:n.description,duration:n.duration,director:n.director};o.value.push(a)}typeof u!="undefined"&&(u.value=l.pgCount)}async function me(e,t,o,u,l){const n=await r("/user/source/list",{method:"POST",handle:!0,body:{id:e,num:t,pg:o}});u.value=[];for(const a of n.movies){let s={id:a.id,name:a.name,description:a.description,duration:a.duration,director:a.director};u.value.push(s)}typeof l!="undefined"&&(l.value=n.pgCount)}function fe(e,t,o,u,l){r("/user/search",{method:"POST",handle:!0,body:{keyword:e,num:t,pg:o}}).then(n=>{u.value=[];for(const a of n.movies){let s={id:a.id,name:a.name,description:a.description,duration:a.duration,director:a.director};u.value.push(s)}typeof l!="undefined"&&(l.value=n.pgCount)})}function ve(e,t,o,u,l,n){r("/user/source/search",{method:"POST",handle:!0,body:{id:e,keyword:t,num:o,pg:u}}).then(a=>{l.value=[];for(const s of a.movies){let c={id:s.id,name:s.name,description:s.description,duration:s.duration,director:s.director};l.value.push(c)}typeof n!="undefined"&&(n.value=a.pgCount)})}async function C(){const e=await r("/user/source/all",{method:"GET",handle:!0,body:{}});g.value=[];for(const t of e){let o={id:t.id,name:t.name,getting:t.get,complete:t.ok,url:t.url,create:!1};g.value.push(o)}p.value=[],p.value=p.value.concat(ae);for(const t of g.value)p.value.push(oe(t.name,t.id))}async function T(){const e=await r("/user/category/all",{method:"GET",handle:!0,body:{}});if(y.value=[],e)for(const t of e){let o={id:t.id,name:t.name,classNum:t.classNum,movieNum:t.movieNum,create:!1};y.value.push(o)}}function we(e){return r("/user/del",{method:"POST",handle:!1,body:{id:e}})}function pe(e){return r("/user/category/del",{method:"POST",handle:!1,body:{id:e}})}function ge(e){return r("/user/source/del",{method:"POST",handle:!1,body:{id:e}})}function ye(e){return r("/user/category/add",{method:"POST",handle:!1,body:{name:e}})}function be(e,t){return r("/user/source/add",{method:"POST",handle:!1,body:{name:e,url:t}})}function _e(e,t){let o=t?"/user/stop/"+e:"/user/start/"+e;return r(o,{method:"GET",handle:!1,body:{}})}function ke(e){return r("/user/updateAccount",{method:"POST",handle:!1,body:{account:e}})}function xe(e){return r("/user/updatePassword",{method:"POST",handle:!1,body:{password:e}})}async function Ce(e,t){const o=await r("/user/source/all_class/"+String(e),{method:"GET",handle:!0,body:{}});t.value=o}function Te(e,t){return r("/user/class/changeGet",{method:"POST",handle:!1,body:{id:e,get:t?1:0}})}function Ae(e,t){return r("/user/class/distribute",{method:"POST",handle:!1,body:{classId:e,categoryId:t}})}export{be as C,ge as D,C as G,_e as H,he as L,ke as U,T as a,ye as b,pe as c,we as d,ne as e,fe as f,ce as g,xe as h,me as i,ve as j,Ce as k,Te as l,p as m,Ae as n,de as o};
